<% title "Welcome to TVTracker" %>



<% if logged_in? %>
   <% if current_user.list_items.size == 0 %>
      You do not follow any shows, yet.
   <% else %>  
      <h3>Your Shows:</h3>
      <table>
      
      <% for list_item in (ListItem.all & current_user.list_items) %>
        <% for episode in list_item.series_item.unseen_episodes(current_user.id) %>
		  	    <% if episode.air_date.nil? || episode.air_date < 1.weeks.ago.to_datetime %>
				 <% break %>
				 <% end %> 

             <%= render :partial => "/episodes/home_episode_row", :locals => {:episode => episode, :list_item => list_item} %>

				<% break # only show one ep%>
        <% end %> 
      <% end %>

      </table>
   <% end %>   
   <br/><br/>
<% else %>
   <%= link_to "Sign up", signup_path %> or
   <%= link_to "Log in", login_path %>.
<% end %> 
